<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>Top 10 Sins of PHP - PhpSlang</title>
    <meta name="description" content="Functional PHP the right way" />
    <meta name="author" content="Witold Adamus">
    <meta charset="UTF-8">
    <link rel="icon" href="../themes/daux/img/favicon-blue.png" type="image/x-icon">
    <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>
    <!-- CSS -->
    <link href='../themes/daux/css/theme-blue.min.css' rel='stylesheet' type='text/css'>
            <!-- Tipue Search -->
        <link href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body class="">
    
<header class="Navbar hidden-print">
    <a class="Navbar__brand" href="../index.html">PhpSlang</a>

    <div class="Search">
        <svg class="Search__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451 451"><path d="M447.05 428l-109.6-109.6c29.4-33.8 47.2-77.9 47.2-126.1C384.65 86.2 298.35 0 192.35 0 86.25 0 .05 86.3.05 192.3s86.3 192.3 192.3 192.3c48.2 0 92.3-17.8 126.1-47.2L428.05 447c2.6 2.6 6.1 4 9.5 4s6.9-1.3 9.5-4c5.2-5.2 5.2-13.8 0-19zM26.95 192.3c0-91.2 74.2-165.3 165.3-165.3 91.2 0 165.3 74.2 165.3 165.3s-74.1 165.4-165.3 165.4c-91.1 0-165.3-74.2-165.3-165.4z"/></svg>
        <input type="search" id="tipue_search_input" class="Search__field" placeholder="Search..." autocomplete="on" results=25 autosave=text_search>
    </div>
</header>
<div class="Columns content">
    <aside class="Columns__left Collapsible">
        <div class="Collapsible__container">
            <button type="button" class="Button Collapsible__trigger">
                <span class="Collapsible__trigger--bar"></span>
                <span class="Collapsible__trigger--bar"></span>
                <span class="Collapsible__trigger--bar"></span>
            </button>
        </div>

        <div class="Collapsible__content">
            <!-- Navigation -->
            <ul class='Nav'><li class='Nav__item  has-children'><a href="../Introduction/Thinking_Functional.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Introduction</a><ul class='Nav'><li class='Nav__item '><a href="../Introduction/Thinking_Functional.html">Thinking Functional</a></li><li class='Nav__item '><a href="../Introduction/Fast_Introduction_To_FP_In_PHP.html">Fast Introduction To FP In PHP</a></li><li class='Nav__item '><a href="../Introduction/Dont_be_afraid_of_monads.html">Dont be afraid of monads</a></li><li class='Nav__item '><a href="../Introduction/FAQ.html">FAQ</a></li></ul></li><li class='Nav__item  has-children'><a href="../Usage/Essentials/Copy_Trait.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Usage</a><ul class='Nav'><li class='Nav__item  has-children'><a href="../Usage/Essentials/Copy_Trait.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Essentials</a><ul class='Nav'><li class='Nav__item '><a href="../Usage/Essentials/Copy_Trait.html">Copy Trait</a></li><li class='Nav__item '><a href="../Usage/Essentials/Option.html">Option</a></li><li class='Nav__item '><a href="../Usage/Essentials/Either.html">Either</a></li><li class='Nav__item '><a href="../Usage/Essentials/Try.html">Try</a></li><li class='Nav__item '><a href="../Usage/Essentials/Future.html">Future</a></li></ul></li><li class='Nav__item '><a href="../Usage/Pattern_Matching.html">Pattern Matching</a></li><li class='Nav__item '><a href="../Usage/Extractors.html">Extractors</a></li><li class='Nav__item  has-children'><a href="../Usage/Immutable_Data_Structures/Parallel_Collections.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Immutable Data Structures</a><ul class='Nav'><li class='Nav__item '><a href="../Usage/Immutable_Data_Structures/Parallel_Collections.html">Parallel Collections</a></li></ul></li><li class='Nav__item '><a href="../Usage/Memoization.html">Memoization</a></li><li class='Nav__item '><a href="../Usage/Trampolines.html">Trampolines</a></li></ul></li><li class='Nav__item  has-children'><a href="../Good_Practices/Common_Mistakes.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Good Practices</a><ul class='Nav'><li class='Nav__item '><a href="../Good_Practices/Common_Mistakes.html">Common Mistakes</a></li><li class='Nav__item  has-children'><a href="../Good_Practices/Tips_and_tricks/Pipelineing.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Tips and tricks</a><ul class='Nav'><li class='Nav__item '><a href="../Good_Practices/Tips_and_tricks/Pipelineing.html">Pipelineing</a></li></ul></li></ul></li><li class='Nav__item Nav__item--open has-children'><a href="../Additional_Articles/Top_10_Sins_of_PHP.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Additional Articles</a><ul class='Nav'><li class='Nav__item Nav__item--active'><a href="../Additional_Articles/Top_10_Sins_of_PHP.html">Top 10 Sins of PHP</a></li></ul></li><li class='Nav__item  has-children'><a href="../General/Roadmap.html" class="folder"><i class="Nav__arrow">&nbsp;</i>General</a><ul class='Nav'><li class='Nav__item '><a href="../General/Roadmap.html">Roadmap</a></li><li class='Nav__item '><a href="../General/Other_Resources.html">Other Resources</a></li><li class='Nav__item '><a href="../General/License.html">License</a></li></ul></li></ul>

            <div class="Links">
                                    <hr/>
                                            <a href="https://github.com/php-slang/php-slang" target="_blank">GitHub Repo</a>
                        <br />
                                            <a href="http://xsolve.pl" target="_blank">Supported by xsolve</a>
                        <br />
                                            <a href="http://wit3k.pl" target="_blank">Made by Witold Adamus</a>
                        <br />
                                    
                
                                    <hr/>
                    <div class="Twitter">
                                                    <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=_phpslang&amp;show_count=false"></iframe>
                            <br />
                            <br />
                                                    <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=xsolve&amp;show_count=false"></iframe>
                            <br />
                            <br />
                                            </div>
                            </div>
        </div>
    </aside>
    <div class="Columns__right ">
        <div class="Columns__right__content">
            <div class="doc_content">
                <article class="Page">

    <div class="Page__header">
        <h1><a href="../Additional_Articles/Top_10_Sins_of_PHP.html">Additional Articles</a> <svg class="Page__header--separator" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 477.175 477.175"><path d="M360.73 229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1 0s-5.3 13.8 0 19.1l215.5 215.5-215.5 215.5c-5.3 5.3-5.3 13.8 0 19.1 2.6 2.6 6.1 4 9.5 4 3.4 0 6.9-1.3 9.5-4l225.1-225.1c5.3-5.2 5.3-13.8.1-19z"/></svg> <a href="../Additional_Articles/Top_10_Sins_of_PHP.html">Top 10 Sins of PHP</a></h1>
                <span style="float: left; font-size: 10px; color: gray;">
            Sunday, February 12, 2017 10:54 AM        </span>
                        <span style="float: right; font-size: 10px; color: gray;">
            <a href="https://github.com/php-slang/php-slang-docs/blob/gh-pages/docs/10_Additional_Articles/01_Top_10_Sins_of_PHP.md" target="_blank">Edit on GitHub</a>
        </span>
            </div>


    <div class="s-content">
        <h2 id="page_Top_10_sins_of_PHP">Top 10 sins of PHP</h2>
<p>PHP is a mature language yet it has it downsides especially in terms of functional programming (but not only).</p>
<p>Purpouse of a following article is pointing out some problems you'll face when you'll
start to code functionally (but not only).</p>
<p><strong>Short note</strong>: <em>Following article compare PHP with other functional languages.
Scala is given as an example but this language was picket from tons of other languages because of its popularity.
Please don't take a false assumption that a basic meaning of this article is that PHP should become Scala.
PHP isn't Scala and will never be and probably should'nt become one. It has it's own upsides, but this article
is focused on downsides - especially in context of functional programming and gives
some answers on PhpSlang purpose and history.</em></p>
<h3 id="page_1_Verbose_anonymous_function_syntax">1. Verbose anonymous function syntax</h3>
<p>When you start to program functionally with PHP you will create new functions - a lot.
And most of pure functions should contain only one return statement.
Let's take a look at a following example.</p>
<pre><code>$users
  -&gt;map(function(User $user) : string {
    return $user-&gt;getFirstName();
  });
</code></pre>
<p>All this simple piece of code does is transforming a list of users into a list of first names of those users.
Now let's slim down this example and cut all redundant information step by step.
So first - we don't need a <code>return</code> statement because pure functions perform only one operation or at least
we could assume that a result of a last statement in a function should be returned.
This is what most Scala, or even Ruby does. So this example could become:</p>
<pre><code class="language-php">$users
  -&gt;map(function(User $user) : string {
    $user-&gt;getFirstName();
  });
</code></pre>
<p>We also do not need a semicolons when we think about our code this way.</p>
<pre><code class="language-php">$users
  -&gt;map(function(User $user) : string {
    $user-&gt;getFirstName()
  })
</code></pre>
<p>Third part is <code>function</code> keyword. We know that <code>map()</code> should receive a function as a 1st parameter and what we
will have is still more than we need to know that this is a function definition.</p>
<pre><code class="language-php">$users
  -&gt;map((User $user) : string {
    $user-&gt;getFirstName()
  })
</code></pre>
<p>Next part of downsizing. Take a look at curly brackets. It's quite obvious that before arguments and returned
type definition there should appear actual implementation.</p>
<pre><code class="language-php">$users
  -&gt;map((User $user) : string $user-&gt;getFirstName())
</code></pre>
<p>Just look at it. This code could all fit in a single line of code.</p>
<p>And because we treat functions as immutable values for object we dont need brackets for
functions with arity 0 (functions that take 0 arguments).</p>
<pre><code class="language-php">$users
  -&gt;map((User $user) : string $user-&gt;getFirstName)
</code></pre>
<p>We could as well remove type annotations (but it's not a good idea as long as point 2 of this list is still valid).</p>
<pre><code class="language-php">$users
  -&gt;map(($user) $user-&gt;getFirstName)
</code></pre>
<p>But all those code examples is just a fantasy. With PHP till this moment we have to stick with:</p>
<pre><code class="language-php">$users
  -&gt;map(function(User $user) : string {
    return $user-&gt;getFirstName();
  });
</code></pre>
<p>This is the same functionality implemented with a Scala for comparision (yes it's a working code).</p>
<pre><code class="language-scala">users
  .map(user =&gt; user.getFirstName)
</code></pre>
<h3 id="page_2_No_generic_types">2. No generic types</h3>
<p>Lack of <a href="https://en.wikipedia.org/wiki/Generic_programming" class="external">generic types</a> touches not only developers who want
to introduce functional programming. This is a problem of a whole community and everyone who
created non trivial OOP application feel this problem.</p>
<p>On 2016-01-06 there was introduced a proposal to implement this feature.
More about a proposal and shape of eventual implementation in PHP you can find at
<a href="https://wiki.php.net/rfc/generics" class="external">https://wiki.php.net/rfc/generics</a></p>
<p><a href="https://www.fervo.se/" class="external">Fervo</a> set a bounty for this feature:
<a href="https://www.bountysource.com/issues/20553561-add-generics-support/backers" class="external">https://www.bountysource.com/issues/20553561-add-generics-support/backers</a></p>
<p>You can ask yourself how such feature could change my life? Well lets consider you have want to pass a list of some
object to your method.</p>
<pre><code class="language-php">function listTransformer(ListCollection $someList);
</code></pre>
<p>OK, so we have a list. But a list of what? There is no way to define such info.
You can (and should) of course try with describing content of iterables inside dockblock.</p>
<pre><code class="language-php">/**
 * @param ListCollection|User[] $someList
 */
function listTransformer(ListCollection $someList);
</code></pre>
<p>So now we now that this parameter had to keep User entities.
Some tools will handle it somehow, some not. The worst part is that such annotation has completely no impact on
how our code will be executed. Dockblock annotation helps only for iterables - how about other
generic methods and classes? There is no easy answer at the moment. All this mess could be resolved when we could
write type definition similar to:</p>
<pre><code class="language-php">function listTransformer(ListCollection&lt;User&gt; $someList);
</code></pre>
<p>Remember that generics are also composable so with generic types you could define more complicated structures.
Take a look at following example in Scala (you can achieve very similar things with Java or C++ as well).</p>
<pre><code class="language-scala">def searchArticles(String searchQuery) : Either&lt;List&lt;Article&gt;, SearchError&gt;
</code></pre>
<p>Such definition in PHP at the moment is limited to:</p>
<pre><code class="language-php">function searchArticles(string $searchQuery) : Either;
</code></pre>
<p>And you as a developer have to remember that Either should contain <code>ListCollection</code> of <code>Article</code>'s or <code>SearchError</code>
entity with detailed information about what happened wrong.</p>
<h3 id="page_3_Convenient_reassignments">3. Convenient reassignments</h3>
<p>When you decide to create purely functional code with PHP it will require a lot of discipline on your side.
And there is no way to stop other team members from breaking your convention.
There are no tools to prevent you from reassignments. Maybe some day PHPMD will be enriched with such functionality but
such features are'nt listed in it's roadmap at the moment.</p>
<p>Even worse - reassignments can occur even by a mistake.
Take a look at following example.</p>
<pre><code class="language-php">$pleaseIDontWantToBecomeMutant = 'regular human';

$someList = [1, 2, 3];

foreach ($someList as $pleaseIDontWantToBecomeMutant) {
  //do nothing
}

echo $pleaseIDontWantToBecomeMutant;
</code></pre>
<p>What do you think what will be the value of a <code>$pleaseIDontWantToBecomeMutant</code>?</p>
<p>Hint: definitely not a <code>regular human</code>.</p>
<h3 id="page_Referential_non_transparency">Referential non-transparency</h3>
<p>Next example. Some developer are very greedy in terms of memory (and they have their reasons).
You probably used a lot of 3rd party libraries or even build-in functions taking arguments via reference.</p>
<pre><code class="language-php">$cow = 'cow';

$chernobylFunction = function(&amp;$someArgument) {
  $someArgument = 'cow producing eggs';
  return $someArgument;
};

echo $chernobylFunction($cow);
echo $cow;
</code></pre>
<p>A sad result of this code is that <code>$chernobylFunction</code> will return  <code>cow producing eggs</code> as expected,
but a regular <code>$cow</code> will become <code>cow producing eggs</code> as well (and you'll see this problem on production
if you don't write enough tests). And our regular <code>cow</code> is lost - no more milk.</p>
<p>When you are a creator of such function you may think - I have it all under control.
The problem is that users of that function don't.
As a library user you have to be very careful and check every function definition if it's arguments are passed
by a copy or a reference.</p>
<h3 id="page_4_Inconvenient_cloning">4. Inconvenient cloning</h3>
<p>Take a look at this class.</p>
<pre><code class="language-php">class House {
  /**
   * @var string
   */
  private $size;

  public function __construct(string $size) {
    $this-&gt;size = $size;
  }

  public function getSize() : string {
    return $this-&gt;size;
  }

  public function setSize(string $newSize) : House {
    $this-&gt;size = $newSize;
    return $this;
  }
}
</code></pre>
<p>Nothing special isn't it? Regular class with getters and setters like we're used to have.
Method <code>setSize</code> returns <code>$this</code> so we have a convenient way to chain few method for one object.</p>
<p>Let's consider a following usage.</p>
<pre><code class="language-php">$smallHouse = new House('small');
$bigHouse = $smallHouse-&gt;setSize('big');

echo $bigHouse-&gt;getSize();    //writes 'big'
echo $smallHouse-&gt;getSize();  //writes 'big' as well :(
</code></pre>
<p>What happened? We mutated a state again - somehow by an accident.
OK, so you transform your code so it's purely functional.
Let's say that You already read a PhpSlang documentation and you know that every function name with <code>set</code> as a prefix
should become a similar function with <code>with</code> as a prefix. How to achieve it?
If you used Scala such method would look somehow like:</p>
<pre><code class="language-scala">case class House(size:Int) {
  def withSize(newSize : Int) = copy(size = newSize)
}
</code></pre>
<p>PHP does not provide any build in features to clone objects with only selected fields changes, so you
end up creating completely new objects copying all fields to constructor and changing those values
you're interested in or with class which looks like this:</p>
<pre><code class="language-php">class House {
  /**
   * @var string
   */
  public $size;

  public function __construct(string $size) {
    $this-&gt;size = $size;
  }

  public function getSize() : string {
    return $this-&gt;size;
  }

  public function withSize(string $newSize) : House {
    $clone = clone $this;
    $clone-&gt;size = $newSize; //note that $size field had to be changed to public
    return $clone;
  }
}
</code></pre>
<p>Does'nt look very beautiful is it?</p>
<p>PhpSlang's <a href="../Usage/Essentials/Copy_Trait.html">Copy trait</a> partially resolves this issue and
allows you to write something like:</p>
<pre><code class="language-php">class House {
  use Copy;

  /**
   * @var string
   */
  private $size;

  public function __construct(string $size) {
    $this-&gt;size = $size;
  }

  public function getSize() : string {
    return $this-&gt;size;
  }

  public function withSize(string $newSize) : House {
    return $this-&gt;copy('size', $newSize);
  }
}
</code></pre>
<p>And now you can use this class in a following way.</p>
<pre><code class="language-php">$smallHouse = new House('small');
$bigHouse = $smallHouse-&gt;withSize('big');

echo $bigHouse-&gt;getSize();    //writes 'big'
echo $smallHouse-&gt;getSize();  //writes 'small' as expected :)
</code></pre>
<h3 id="page_5_Very_little_syntactic_sugar">5. Very little syntactic sugar</h3>
<h4 id="page_No_placeholder_syntax">No placeholder syntax</h4>
<h4 id="page_No_partially_applied_functions">No partially applied functions</h4>
<h4 id="page_No_implicit_scoping">No implicit scoping</h4>
<h4 id="page_No_wildcard_import">No wildcard import</h4>
<h4 id="page_No_pipeline_operator">No pipeline operator</h4>
<p>https://wiki.php.net/rfc/pipe-operator</p>
<h3 id="page_6_Imperative_ecosystem">6. Imperative ecosystem</h3>
<h3 id="page_7_Lack_of_Closure_descriptions">7. Lack of Closure descriptions</h3>
<h3 id="page_8_No_pattern_matching">8. No pattern matching</h3>
<h3 id="page_9_No_macros">9. No macros</h3>
<h3 id="page_10_No_standard_for_annotations">10. No standard for annotations</h3>
    </div>

        <nav>
        <ul class="Pager">
            <li class=Pager--prev><a href="../Good_Practices/Tips_and_tricks/Pipelineing.html">Previous</a></li>            <li class=Pager--next><a href="../General/Roadmap.html">Next</a></li>        </ul>
    </nav>
    </article>

            </div>
        </div>
    </div>
</div>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-86414385-1', '');
    ga('send', 'pageview');
</script>

    <!-- jQuery -->
    <script src="../themes/daux/js/jquery-1.11.3.min.js"></script>

    <!-- hightlight.js -->
    <script src="../themes/daux/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- JS -->
    
    <script src="../themes/daux/js/daux.js"></script>

            <!-- Tipue Search -->
        <script type="text/javascript" src="../tipuesearch/tipuesearch.js"></script>

        <script>
            window.onunload = function(){}; // force $(document).ready to be called on back/forward navigation in firefox
            $(function() {
                tipuesearch({
                    'base_url': '../'
                });
            });
        </script>
    
</body>
</html>
