<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>Thinking Functional - PhpSlang</title>
    <meta name="description" content="Functional PHP the right way" />
    <meta name="author" content="Witold Adamus">
    <meta charset="UTF-8">
    <link rel="icon" href="../themes/daux/img/favicon-blue.png" type="image/x-icon">
    <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>
    <!-- CSS -->
    <link href='../themes/daux/css/theme-blue.min.css' rel='stylesheet' type='text/css'>
            <!-- Tipue Search -->
        <link href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body class="">
    
<header class="Navbar hidden-print">
    <a class="Navbar__brand" href="../index.html">PhpSlang</a>

    <div class="Search">
        <svg class="Search__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451 451"><path d="M447.05 428l-109.6-109.6c29.4-33.8 47.2-77.9 47.2-126.1C384.65 86.2 298.35 0 192.35 0 86.25 0 .05 86.3.05 192.3s86.3 192.3 192.3 192.3c48.2 0 92.3-17.8 126.1-47.2L428.05 447c2.6 2.6 6.1 4 9.5 4s6.9-1.3 9.5-4c5.2-5.2 5.2-13.8 0-19zM26.95 192.3c0-91.2 74.2-165.3 165.3-165.3 91.2 0 165.3 74.2 165.3 165.3s-74.1 165.4-165.3 165.4c-91.1 0-165.3-74.2-165.3-165.4z"/></svg>
        <input type="search" id="tipue_search_input" class="Search__field" placeholder="Search..." autocomplete="on" results=25 autosave=text_search>
    </div>
</header>
<div class="Columns content">
    <aside class="Columns__left Collapsible">
        <div class="Collapsible__container">
            <button type="button" class="Button Collapsible__trigger">
                <span class="Collapsible__trigger--bar"></span>
                <span class="Collapsible__trigger--bar"></span>
                <span class="Collapsible__trigger--bar"></span>
            </button>
        </div>

        <div class="Collapsible__content">
            <!-- Navigation -->
            <ul class='Nav'><li class='Nav__item Nav__item--open has-children'><a href="../Introduction/Thinking_Functional.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Introduction</a><ul class='Nav'><li class='Nav__item Nav__item--active'><a href="../Introduction/Thinking_Functional.html">Thinking Functional</a></li><li class='Nav__item '><a href="../Introduction/Fast_Introduction_To_FP_In_PHP.html">Fast Introduction To FP In PHP</a></li><li class='Nav__item '><a href="../Introduction/Monads_for_dummies.html">Monads for dummies</a></li><li class='Nav__item '><a href="../Introduction/FAQ.html">FAQ</a></li></ul></li><li class='Nav__item  has-children'><a href="../Usage/Essentials/Copy_Trait.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Usage</a><ul class='Nav'><li class='Nav__item  has-children'><a href="../Usage/Essentials/Copy_Trait.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Essentials</a><ul class='Nav'><li class='Nav__item '><a href="../Usage/Essentials/Copy_Trait.html">Copy Trait</a></li><li class='Nav__item '><a href="../Usage/Essentials/Option.html">Option</a></li><li class='Nav__item '><a href="../Usage/Essentials/Either.html">Either</a></li><li class='Nav__item '><a href="../Usage/Essentials/Try.html">Try</a></li><li class='Nav__item '><a href="../Usage/Essentials/Future.html">Future</a></li></ul></li><li class='Nav__item '><a href="../Usage/Pattern_Matching.html">Pattern Matching</a></li><li class='Nav__item '><a href="../Usage/Extractors.html">Extractors</a></li><li class='Nav__item  has-children'><a href="../Usage/Immutable_Data_Structures/Overview.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Immutable Data Structures</a><ul class='Nav'><li class='Nav__item '><a href="../Usage/Immutable_Data_Structures/Overview.html">Overview</a></li><li class='Nav__item '><a href="../Usage/Immutable_Data_Structures/List.html">List</a></li><li class='Nav__item '><a href="../Usage/Immutable_Data_Structures/Set.html">Set</a></li><li class='Nav__item '><a href="../Usage/Immutable_Data_Structures/HashMap.html">HashMap</a></li><li class='Nav__item '><a href="../Usage/Immutable_Data_Structures/Parallel_Collections.html">Parallel Collections</a></li><li class='Nav__item '><a href="../Usage/Immutable_Data_Structures/Basic_Examples.html">Basic Examples</a></li><li class='Nav__item '><a href="../Usage/Immutable_Data_Structures/More_Examples.html">More Examples</a></li></ul></li><li class='Nav__item '><a href="../Usage/Memoization.html">Memoization</a></li><li class='Nav__item '><a href="../Usage/Trampolines.html">Trampolines</a></li></ul></li><li class='Nav__item  has-children'><a href="../Good_Practices/Common_Mistakes.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Good Practices</a><ul class='Nav'><li class='Nav__item '><a href="../Good_Practices/Common_Mistakes.html">Common Mistakes</a></li><li class='Nav__item  has-children'><a href="../Good_Practices/Tips_and_tricks/Pipelineing.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Tips and tricks</a><ul class='Nav'><li class='Nav__item '><a href="../Good_Practices/Tips_and_tricks/Pipelineing.html">Pipelineing</a></li></ul></li></ul></li><li class='Nav__item  has-children'><a href="../Additional_Articles/Top_10_Sins_of_PHP.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Additional Articles</a><ul class='Nav'><li class='Nav__item '><a href="../Additional_Articles/Top_10_Sins_of_PHP.html">Top 10 Sins of PHP</a></li></ul></li><li class='Nav__item  has-children'><a href="../General/Roadmap.html" class="folder"><i class="Nav__arrow">&nbsp;</i>General</a><ul class='Nav'><li class='Nav__item '><a href="../General/Roadmap.html">Roadmap</a></li><li class='Nav__item '><a href="../General/Other_Resources.html">Other Resources</a></li><li class='Nav__item '><a href="../General/License.html">License</a></li></ul></li></ul>

            <div class="Links">
                                    <hr/>
                                            <a href="https://github.com/php-slang/php-slang" target="_blank">GitHub Repo</a>
                        <br />
                                            <a href="http://xsolve.pl" target="_blank">Supported by xsolve</a>
                        <br />
                                            <a href="http://wit3k.pl" target="_blank">Made by Witold Adamus</a>
                        <br />
                                    
                
                                    <hr/>
                    <div class="Twitter">
                                                    <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=_phpslang&amp;show_count=false"></iframe>
                            <br />
                            <br />
                                                    <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=xsolve&amp;show_count=false"></iframe>
                            <br />
                            <br />
                                            </div>
                            </div>
        </div>
    </aside>
    <div class="Columns__right ">
        <div class="Columns__right__content">
            <div class="doc_content">
                <article class="Page">

    <div class="Page__header">
        <h1><a href="../Introduction/Thinking_Functional.html">Introduction</a> <svg class="Page__header--separator" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 477.175 477.175"><path d="M360.73 229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1 0s-5.3 13.8 0 19.1l215.5 215.5-215.5 215.5c-5.3 5.3-5.3 13.8 0 19.1 2.6 2.6 6.1 4 9.5 4 3.4 0 6.9-1.3 9.5-4l225.1-225.1c5.3-5.2 5.3-13.8.1-19z"/></svg> <a href="../Introduction/Thinking_Functional.html">Thinking Functional</a></h1>
                <span style="float: left; font-size: 10px; color: gray;">
            Monday, February 13, 2017 12:01 AM        </span>
                        <span style="float: right; font-size: 10px; color: gray;">
            <a href="https://github.com/php-slang/php-slang-docs/blob/gh-pages/docs/00_Introduction/01_Thinking_Functional.md" target="_blank">Edit on GitHub</a>
        </span>
            </div>


    <div class="s-content">
        <h1 id="page_Why">Why?</h1>
<p>Functional programming became a buzzword of all software conferences in few last years.
PHP community does it's best to keep pace because there is a lot to gain.</p>
<p>What are the biggest benefits of functional programming?</p>
<ul>
<li>Less bugs</li>
<li>Maintainable code</li>
<li>Scalability out of box</li>
<li>Easier testing</li>
<li>Shorter code</li>
<li>Easy to learn</li>
</ul>
<p>You gain all of this by switching to FP (and PhpSlang will help you with it).
Take all of these advantages for granted at the moment - we will cover points above in a while.</p>
<h2 id="page_Short_intro">Short intro</h2>
<p>Some people say that when you want to learn program functionally you have to forget everything you know about
programming and go back to school and your math teacher should be your programming master from this day.
There's a lot of truth in such thinking, but not completely - eg. OOP and FP create a great couple so all you know about
inheritance, composition etc. is still on the menu.
Staring to code purely functional does not discard all good practices like
<a href="https://en.wikipedia.org/wiki/Don't_repeat_yourself" class="external">DRY</a>,
<a href="https://en.wikipedia.org/wiki/SOLID_(object-oriented_design)" class="external">SOLID</a>,
<a href="https://en.wikipedia.org/wiki/You_aren't_gonna_need_it" class="external">YAGNI</a> neither.</p>
<p>Even more - if you're familiar with <a href="https://en.wikipedia.org/wiki/Domain-driven_design" class="external">Domain Driven Design</a> - you'll
see that functional thinking can be applied not only to specific pieces of code, but to the architectural decisions as
well. See this <a href="https://www.youtube.com/watch?v=kZL41SMXWdM" class="external">great Greg Young's talk</a> for a reference (if you ask
yourself what event sourcing has to do with DDD check out Eric Evans
<a href="https://books.google.pl/books/about/Domain_Driven_Design.html?id=hHBf4YxMnWMC&amp;source=kp_cover&amp;redir_esc=y" class="external">book</a>).</p>
<h2 id="page_The_problem_with_imperative_programming">The problem (with imperative programming)</h2>
<h3 id="page_Every_day_headache">Every day headache</h3>
<p>Does <a href="http://turnoff.us/geek/the-depressed-developer/" class="external">this story</a> feel familiar to you?
Or bunch of other funny pictures about developers struggling with NullPointerExceptions or OutOfBoundExceptions?
There are tons of everyday small glitches in our projects. Sometimes such problems are resolved at code review when
other developers in your team find it, sometimes on production instance when angry clients start to call a support line.
We have to keep in mind lots of tiny dependencies that sum up to huge graph of connections which most developers have to
keep in mind when maintaining existing code.
The problem is that we are just humans and our buffer is quite tiny and <a href="http://i.imgur.com/3uyRWGJ.jpg" class="external">easy to flush</a>.</p>
<h3 id="page_Scalability_issues">Scalability issues</h3>
<p>How many simultaneous threads with concurrent access to your data you're able to implement with full confidence?
2? 10? 20? What would you say about 100000? It is possible with pure functions. With shared mutable state
<a href="http://henrikeichenhardt.blogspot.de/2013/06/why-shared-mutable-state-is-root-of-all.html" class="external">not</a>.
And scalability is just one dimension of a whole problem.</p>
<h3 id="page_Mutability_is_counterintuitive">Mutability is counterintuitive</h3>
<p>The business requirements tend to grow and change.
FP won't solve all your problems with complexity but will not create separate complexity on it's own and using immutable
data structures and monads will help you handle this complexity.</p>
<p>Imperative style can seem like a standard way of giving your computer instructions to process.
That's how computers work - instruction after instruction, are'nt they?
Well maybe (as long we're using Von Neumann computers) but it's definitely not how human brains work
and not how the world around us works.
Do you remember when the last time some physical object in your surrounding was just reasigned?</p>
<h2 id="page_The_solution">The solution</h2>
<h3 id="page_1_Immutability">1. Immutability!</h3>
<p>The biggest difference between eg. Haskell and PHP is that you CAN NOT reassign values.
Keeping immutability will require a lot more discipline on your side when you use PHP,
but syntax in not important - thinking is!</p>
<p>From this day just keep in mind that:</p>
<p><strong>There is no such thing as variable!</strong></p>
<p>Forget about changing state of variables in random places.
All your code should be build of small logical blocks which are:</p>
<p><strong>Easy to reason about</strong></p>
<p>Every function should return the same result when run with the same set of input data. This way you don't have to think
about tons of dependencies inside your code. When you want to do something - you just run a function and you can be sure
that it will behave in the same way every time.</p>
<h3 id="page_2_Ask_a_right_questions">2. Ask a right questions</h3>
<p>Imperative paradigm which is a standard for most of PHP applications leaves you with a code that describes HOW TO
achieve things.
Functional paradigm leaves you with a code that describes WHAT you want to achieve.</p>
<h3 id="page_3_Function_as_a_first_class_citizen">3. Function as a first class citizen</h3>
<p>It must be mentioned because - well it's a functional programming.
Points below are rather a technical detail - but when you have these tools,
completely new possibilities are open for you.</p>
<ul>
<li>Currying - functions can return another functions as well.</li>
<li>Higher order functions - functions can be passed as arguments to other functions.</li>
<li>Anonymous functions - you can define a function just in a place you use them.</li>
<li>Functions can be assigned to a variable (and object scope as well).</li>
</ul>
<h2 id="page_Pros">Pros</h2>
<h3 id="page_Less_bugs">Less bugs</h3>
<p>Immutability - again. Lets consider a following linear function you can remember from your childhood:</p>
<p><code>f(x) = x * 2</code></p>
<p>When x equals 2 you just know that the result of computation is 4. When 6 it's 12, when 7 it's 14 and so on.</p>
<p>More important than what this function does is what this function DOES NOT.
This function DOES NOT:</p>
<ul>
<li>set any kind of variables which are reused in next executions</li>
<li>add new objects to globally available array</li>
<li>create a temporary array to accumulate computed data</li>
</ul>
<p>This is just a simple example, but it's actually an ultimate point of FP.</p>
<h3 id="page_Maintainable_code">Maintainable code</h3>
<p>Code describes WHAT it does, not HOW. So you don't have to think that much on what was the intention of
a developer who created this piece of code - this information is already here.
Having a project written in a purely functional manner means also easier debugging and code navigation.
As long as all function calls are explicit, you'll see very little or no surprises when debugging.</p>
<h3 id="page_Scalability_out_of_box">Scalability out of box</h3>
<p>The biggest challenge of distributed architecture is concurrent access to data. You never know if a state is up
to date and who uses specific entities at the moment.
Concurrency creates tons of problems which can be solved using ideas like locks, mutexes, semaphores etc. but it
requires a lot of effort and creates new problems you have to keep in mind when extending existing solutions.</p>
<p>With <strong>immutable</strong> code and immutable data structures you can forget about all this stuff. When result of a function
is the same every time, there is no risk of running it in parallel on few CPU cores or even few physical machines.
You don't share a memory so code is not only more predictable but simply works faster.</p>
<p>Check <a href="../Usage/Essentials/Future.html">Future</a> and
<a href="../Usage/Immutable_Data_Structures/Parallel_Collections.html">Parallel Collections</a>
for more information on this topic.</p>
<h3 id="page_Easier_testing">Easier testing</h3>
<p>No initialization. No tests for various states of dependent variables.
No side effects checks. Much less mocking and stubbing.</p>
<p>Just simple checks for return value and domain specific edge cases.
And again: <a href="https://en.wikipedia.org/wiki/Test-driven_development" class="external">TDD</a>
and <a href="https://en.wikipedia.org/wiki/Behavior-driven_development" class="external">BDD</a> are still on the menu.</p>
<h3 id="page_Shorter_code">Shorter code</h3>
<p>When you use nested function calls you end up with a much more condensed code.
Pipelined calls also tend to take less space and when everything is immutable,
most of your functions contain only one return statement - which appears in a first line of a method
(yes braces, semicolon and <code>return</code> keyword become to seem redundant - but unfortunately
you still have to use them in PHP).</p>
<p>Code condensation is visible especially for immutable collections - when you chain eg. <code>map()</code> and <code>filter()</code>
calls it becomes readable even for people with no developing skills.</p>
<h3 id="page_Easy_to_learn">Easy to learn</h3>
<p>One of the biggest myths of functional programming is that it has a big entry level.
Source of such a belief can be found in a track of life of an experienced software developers.
They are used to see small increments. When you develop with Zend for 3 years and then jump to Symfony - most of
concepts are the same, only approach to solve problems is different.
Functional programming requires you to really change the way you think (and it can be painful at the beginning), but
it's really not that much to learn (there's actually less things you have to learn to start compared to OOP).
When currying and monads give you a headache remember days when questions like
'what is a difference between interface and abstract class' were hard to answer for you - you have to
fill the gaps in your knowledge but from a perspective it's actually not that hard.</p>
<h2 id="page_OK_but_my_app_has_to_store_user_input">OK, but my app has to store user input.</h2>
<p>It can seem like a not so easy question to answer keeping in mind that all materials about FP repetitively convince
you not mutate data at all, but it does'nt mean that FP is limited only to transform data without side effects.
For an average PHP developer the simple answer is - store all your state changes in a database. That is the only place
where data changes should happen.</p>
<p>Immutability also does'nt mean that you cant create eg. database engine with purely functional language - check
Haskel's <a href="https://wiki.haskell.org/Software_transactional_memory" class="external">STM</a> for a reference.
There's also a high chance that you are familiar with <a href="https://www.rabbitmq.com/" class="external">RabbitMQ</a>
which is written in <a href="https://www.erlang.org/" class="external">Erlang</a>.
There is a lot of other software written in purely functional languages which are capable of storing varying data,
only approach to data changes is different.</p>
<h2 id="page_Show_me_the_code">Show me the code</h2>
<p>It's a prolixity without showing the code, so let's see this small example.
Both functions below return the same result for identical input. The only difference is used paradigm.</p>
<p>Imperative implementation:</p>
<pre><code class="language-php">function averageOfNumbersSmallerThan(array $numbers, int $threshold) : string {
  $numbersSmallerThanThreshold = [];
  foreach ($numbers as $number) {
    if ($number &lt;= $threshold) {
      $numbersSmallerThanThreshold[] = $number;
    }
  }
  $numbersDividedByThree = [];
  foreach ($numbersSmallerThanThreshold as $number) {
    $numbersDividedByThree = $number / 3;
  }
  $average = null;
  if (count($numbersDividedByThree) &gt; 0) {
    foreach ($numbersDividedByThree as $number) {
      if (is_null($average) {
        $average = $number;
      } else {
        $average = ($average + $number) / 2;
      }
    }
  }
  if (is_null($average) {
    return 'It\'s impossible to count average for a given data.'; 
  } else {
    return 'Average is: ' . $average;
  }
}
?&gt;
</code></pre>
<p>Functional implementation (using PhpSlang):</p>
<pre><code class="language-php">function averageOfNumbersSmallerThan(ListCollection $numbers, int $threshold) : string {
  return $numbers
    -&gt;filter(function($number) use ($threshold) { return $number &lt;= $threshold; })
    -&gt;map(function($number) { return $number / 3; })
    -&gt;avg()
    -&gt;map(function($avg) { return 'Average is: ' . $avg; })
    -&gt;getOrElse('It\'s impossible to count average for a given data.');
}
?&gt;
</code></pre>
<h2 id="page_Summing_things_up">Summing things up</h2>
<p>Does an example above look convincing?
It's just a beginning. Remember that this example describes only one method and we're just scrapping the surface here.
We did'nt even touched the danger zones of exception handling, mutable object fields,
validation and any kind of storage.</p>
<p>The most important facts to remember before reading other materials on functional programming are:</p>
<ul>
<li>immutability - lets you deal with complexity and helps you create code which won't surprise you</li>
<li>WHAT not HOW - this is the question that should be answered by your code</li>
<li>treat function as a first class citizen - your system is composed of functions - they deserve some respect.</li>
</ul>
<p>Have fun with functional programming!</p>
    </div>

        <nav>
        <ul class="Pager">
            <li class=Pager--prev><a href="../index.html">Previous</a></li>            <li class=Pager--next><a href="../Introduction/Fast_Introduction_To_FP_In_PHP.html">Next</a></li>        </ul>
    </nav>
    </article>

            </div>
        </div>
    </div>
</div>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-86414385-1', '');
    ga('send', 'pageview');
</script>

    <!-- jQuery -->
    <script src="../themes/daux/js/jquery-1.11.3.min.js"></script>

    <!-- hightlight.js -->
    <script src="../themes/daux/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- JS -->
    
    <script src="../themes/daux/js/daux.js"></script>

            <!-- Tipue Search -->
        <script type="text/javascript" src="../tipuesearch/tipuesearch.js"></script>

        <script>
            window.onunload = function(){}; // force $(document).ready to be called on back/forward navigation in firefox
            $(function() {
                tipuesearch({
                    'base_url': '../'
                });
            });
        </script>
    
</body>
</html>
